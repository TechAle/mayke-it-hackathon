<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Two Columns with Bootstrap</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="scripts/listConversations.js"></script>

    <style>
        #greenDiv {
            background-color: green;
            min-width: 200px;
            max-width: 300px;
            flex: 1 0 10%;
        }

        #greenDiv > * {
            margin-top: 5px;
        }

        #redDiv {
            background-color: red;
            flex: 5;
            height: 100vh;
        }

        .chatSelector:hover, #back:hover, #arrow:hover, .message > img:hover, #closeOverlay:hover {
            cursor: pointer;
        }

        .maxHeight {
            height: 100vh;
        }

        .flex-container {
            display: flex;
            flex-direction: row;
            justify-content: flex-start;
            gap: 10px; /* adjust as needed */
        }

        #back {
            display: flex;
            align-items: center;
            justify-content: center; /* if you also want to center the text horizontally */
        }

        #nameSection {
            padding-top: 7px;
        }

        #headerChat {
            margin-left: 10px;
        }

        #mainBody > * {
            padding-top: 8px;
        }

        #diary {
            margin-top: 0;
        }

        #greenDiv > div > div > img {
            height: 64px;
            width: 60px;
        }

        .image-text-container {
            display: flex;
            align-items: center;
            height: 80px;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
        }

        .image-text-container img {
            margin-right: 10px;
        }

        #greenDiv > div {
            margin-left: 0;
        }

        #headerChat {
            height: 10%;
        }

        #chat {
            background-color: yellow;
            height: 82%;
            overflow-y: scroll;
            padding: 10px;
        }

        #input {
            height: 8%;
            padding-top: 8px;
            text-align: center;
        }

        #input > label {
            width: 100%;
        }

        #selectInput {
            display: initial !important;
            width: 80%;
        }

        .message {
            color: #000;
            clear: both;
            line-height: 18px;
            font-size: 15px;
            padding: 8px;
            position: relative;
            margin: 8px 0;
            max-width: 85%;
            word-wrap: break-word;
        }

        .message:after {
            position: absolute;
            content: "";
            width: 0;
            height: 0;
            border-style: solid;
        }

        .message:first-child {
            margin: 16px 0 8px;
        }

        .message.received {
            background: #fff;
            border-radius: 0px 5px 5px 5px;
            float: left;
        }


        .message.received .metadata {
            padding: 0 0 0 16px;
        }

        .message.received:after {
            border-width: 0px 10px 10px 0;
            border-color: transparent #fff transparent transparent;
            top: 0;
            left: -10px;
        }

        .message.sent {
            background: #e1ffc7;
            border-radius: 5px 0px 5px 5px;
            float: right;
        }

        .message.sent:after {
            border-width: 0px 0 10px 10px;
            border-color: transparent transparent transparent #e1ffc7;
            top: 0;
            right: -10px;
        }

        .message > img {
            height: 256px;
            width: auto;
        }

        #overlay {
            position: absolute;
            height: 100vh;
            width: 100vw;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 1;
            display: none;
        }

        #overlayPicture {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            height: 100vh;
            width: auto;
        }

        #closeOverlay {
            position: absolute;
            color: white;
            font-size: 50px;
            padding: 10px;
            width: 128px;
        }


    </style>
</head>
<body>
<div id="overlay">
    <img id="closeOverlay" src="images/conversation/close.png"/>
    <img src="images/home/techale.png" alt="Description of image" id="overlayPicture"/>
</div>
<div class="container-fluid maxHeight">
    <div class="row maxHeight" id="mainBody">
        <div class="container conversations" id="greenDiv">
        </div>
        <div id="redDiv">
            <div id="headerChat">
                <div class="row" style="margin: 0">
                    <div class="col-4 flex-container" id="goBackSection">
                        <div id="back">Back</div>
                        <img style="height: 64px" src="images/home/techale.png" alt="Image description" class=" rounded-circle">
                    </div>
                    <div class="col-8 text-center" id="nameSection">
                        <div>Name 1</div>
                        <div>Status</div>
                    </div>
                </div>
            </div>
            <div id="chat">
                <div class="message received">
                    Test
                </div>

                <div class="message sent">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Platea dictumst quisque sagittis purus sit amet volutpat consequat mauris. Quis eleifend quam adipiscing vitae proin sagittis nisl rhoncus mattis. Ornare lectus sit amet est placerat in. A lacus vestibulum sed arcu non odio euismod lacinia at. Velit laoreet id donec ultrices tincidunt. Tellus in metus vulputate eu scelerisque felis imperdiet proin fermentum. Porta non pulvinar neque laoreet suspendisse interdum consectetur libero id. Iaculis at erat pellentesque adipiscing. Rhoncus est pellentesque elit ullamcorper dignissim. Quam id leo in vitae turpis. Quis ipsum suspendisse ultrices gravida dictum fusce ut. Aliquet bibendum enim facilisis gravida neque convallis a. Nec dui nunc mattis enim ut tellus. Augue lacus viverra vitae congue eu consequat.
                </div>

                <div class="message sent">
                    <img src="images/home/bepp.jpeg" alt="Description of image"/>
                </div>

            </div>
            <div id="input">
                <label>
                    Response:
                    <select class="form-control" id="selectInput">
                        <option value="option1">Option 1</option>
                        <option value="option2">Option 2</option>
                        <option value="option3">Option 3</option>
                    </select>
                    <span id="arrow">Send</span>
                </label>
            </div>
        </div>
    </div>
</div>


<script src="scripts/resize.js"></script>
<script src="scripts/pictures.js"></script>
<script src="scripts/conversationManager.js"></script>
<script>

    $(document).ready(function () {
        $(".chatSelector").click(function () {
            changeConversation($(this).attr('id'))
            if (window.matchMedia("(max-width: 575px)").matches) {
                showConversation()
            }
        });

        $("#back").click(function () {
            if (window.matchMedia("(max-width: 575px)").matches) {
                showChatSelection()
            }
        });
        changeHeaderPadding()
        loadConversations()
    });

    $('#arrow').click(() => {
        newMessage($('#selectInput').val(), false)
        sendMessage($('#selectInput').val())
    });

    function sendMessage(message) {
        const currentChatOptions = conversations[currentChat]["messages"][message]
        newMessage(currentChatOptions["text"], true)
        const options = currentChatOptions["options"]
        console.log(options)
        $("#selectInput").empty()
        options.forEach(option => {
            $("#selectInput").append(`<option value="${option}">${option}</option>`)
        })

    }

    let currentChat = null
    function changeConversation(id) {
        $("#chat").empty()
        currentChat = id
        sendMessage("firstMessage")
    }



</script>


<!-- Bootstrap JS Bundle with Popper -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>


</body>
</html>
